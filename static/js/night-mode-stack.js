function sleep(t){return new Promise(e=>setTimeout(e,t))}let pixels,originalPixels,context;async function showDiff(){await sleep(500),context.putImageData(pixels,0,0),await sleep(500),context.putImageData(originalPixels,0,0),requestAnimationFrame(showDiff)}async function drawToCanvas(t,e,a){e(1),context=t.getContext("2d");let i=context.canvas.width,n=context.canvas.height;context.scale(i/1e3,n/1e3);let o=await fetch("/static/images/night-mode/examples/1.jpg"),s=await o.blob(),c=await createImageBitmap(s);context.drawImage(c,0,0),pixels=context.getImageData(0,0,context.canvas.width,context.canvas.height),originalPixels=context.getImageData(0,0,context.canvas.width,context.canvas.height);for(let t=2;t<=10;t++){e(t);let i=a[`/static/images/night-mode/examples/${t}.jpg`]||`/static/images/night-mode/examples/${t}.jpg`,n=[(await fetch(i)).blob(),sleep(1e3)],[o]=await Promise.all(n),s=await createImageBitmap(o);context.drawImage(s,0,0);let c=context.getImageData(0,0,context.canvas.width,context.canvas.height);for(let e=0;e<c.data.length;e++)pixels.data[e]=(pixels.data[e]*(t-1)+c.data[e])/(t-1+1);context.putImageData(pixels,0,0)}showDiff()}