function clonePixels(t,e,n){return new ImageData(new Uint8ClampedArray(t),e,n)}const noisyImage=new Image;noisyImage.src="/static/images/night-mode/noise.jpg";const outputCanvas=document.getElementById("noisy-image"),outputCanvasContext=outputCanvas.getContext("2d"),outputContainer=document.getElementById("output-container");let oldWidth=400,oldHeight=393,newWidth=outputContainer.clientWidth,newHeight=outputContainer.clientHeight;outputCanvas.width=newWidth,outputCanvas.height=newHeight,noisyImage.onload=function(){outputCanvasContext.drawImage(noisyImage,0,0)};let cached={};function increaseBrightness(){let t=parseInt(document.getElementById("brightnessSlider").value),e=clonePixels(outputCanvasContext.getImageData(0,0,outputCanvas.width,outputCanvas.height).data,outputCanvas.width,outputCanvas.height);for(let n=0;n<e.data.length;n+=4)cached[n]||(cached[n]=e.data[n],cached[n+1]=e.data[n+1],cached[n+2]=e.data[n+2]),e.data[n]=cached[n]+t,e.data[n+1]=cached[n+1]+t,e.data[n+2]=cached[n+2]+t;outputCanvasContext.putImageData(e,0,0)}let stackContainer=document.getElementById("stack-container");async function stackImages(t){let e;t.disabled=!0,t.innerText="Stacking Images";try{let t=await fetch("/static/assetMap.json");e=await t.json()}catch(t){e={"/static/js/night-mode-worker.js":"/static/js/night-mode-worker.js","/static/js/night-mode-stack.js":"/static/js/night-mode-stack.js"}}let n=document.querySelector("#canvas"),a=document.getElementById("stack-container");if(n.width=a.clientWidth,n.height=a.clientWidth,n.transferControlToOffscreen){let t=new Worker(e["/static/js/night-mode-worker.js"]),a=n.transferControlToOffscreen();t.postMessage({canvas:a,assetMap:e},[a]),t.onmessage=function(t){updateProgress(t.data)}}else{function s(t){updateProgress(t)}let t=document.createElement("script");t.setAttribute("src",e["/static/js/night-mode-stack.js"]),t.onload=function(){drawToCanvas(n,s,e)},document.body.appendChild(t)}}function updateProgress(t){document.getElementById("result").innerText=`🚧 Processing ${t} of 10`,10===t&&(document.getElementById("result").innerText="✔️ Processing complete. Showing Before, After.",document.getElementById("stack-images").style.display="none")}stackContainer.style.height=stackContainer.clientWidth+"px",stackContainer.style.background="#333";